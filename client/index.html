<!doctype html>
<html>
    <head>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
        <script src="http://cdn.sockjs.org/sockjs-0.3.min.js"></script>
        <link href="style.css" rel="stylesheet">
        <script src="TURTED.js" type="text/javascript"></script>

    </head>
    <body lang="en">
        <h1>TURTED example</h1>

        <div id="first" class="box">
            <div></div>
            <form><input autocomplete="off" placeholder="Type here..." /></form>
            <button id="ok">Say Hello</button>
            <button id="echo">ECHO</button>
        </div>

        <script type="text/javascript">

            var sockjs_url = '/turted';
            if (document.location.protocol === "file:") {
                sockjs_url = 'http://localhost/turted';
            }

            var turted = new TURTED(sockjs_url);
            turted.on("message", function(data) {
                alert(data)
            })

            var sockjs;

            $('#first input').focus();

            $('#echo').click(function() {
                turted.echo("Hello, echo!!");
            })

            $('#ok').click(function() {
                turted.send("Hello");
            })

            var div = $('#first div');
            var inp = $('#first input');
            var form = $('#first form');

            var print = function (m, p) {
                p = (p === undefined) ? '' : JSON.stringify(p);
                div.append($("<code>").text(m + ' ' + p));
                div.append($("<br>"));
                div.scrollTop(div.scrollTop() + 10000);
            };

            form.submit(function () {
                print('[ ] sending', inp.val());
                turted.send(inp.val());
                inp.val('');
                return false;
            });

        </script>
    </body>
</html>
